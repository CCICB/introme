
class ESEfinder_motifs(object):
    _A1_Hazeem=[[-1.58496, 1.52119, -1.23807, 0.08158, -0.04756, -0.04756],
    [0.15940, -1.58496, -1.58496, -0.77584, -0.56049, -0.20738],
    [-1.58496, -1.45744, 1.50012, 0.39960, 0.29481, -0.02875],
    [1.22156, -1.58496, -1.44755, 0.04664, 0.17989, 0.26233]]

    _A1_Hazeem_july=[[-1.58496, 1.08580, -1.22876, 0.02561, -0.04211, -0.06541],
    [0.62685, -1.45158, -1.51672, -0.79711, -0.75719, -0.07882],
    [-1.58496, 0.13105, 1.49009, 0.32630, 0.43190, -0.09481],
    [0.90900, -1.58496, -1.44358, 0.21041, 0.12218, 0.23166]]

    _A1_neuBG=[[-1.58500, 1.58500, -1.58500, -1.58500, -1.58500, 0.97300],
    [-0.66700, -1.58500, -1.58500, -1.58500, -1.05400, -1.58500],
    [-1.58500, -1.58500, 1.58500, 1.58500, 1.26700, -1.58500],
    [1.43500, -1.58500, -1.58500, -1.58500, -0.36300, 0.45500]]

    _A1_winBG=[[-1.58500, 1.28700, -1.58500, -1.58500, -1.58500, 0.69700],
    [0.24800, -1.58500, -1.58500, -1.58500, -0.39500, -1.58500],
    [-1.58500, -1.58500, 1.15500, 1.15500, 0.85300, -1.58500],
    [1.46100, -1.58500, -1.58500, -1.58500, -0.34500, 0.47700]]

    _SC35=[[-0.88295, 0.09027, -0.05874, -1.58496, 0.09027, -0.41277, -0.05874, 0.22531],
    [-1.15939, -1.58496, 0.95194, 1.11318, 0.56268, 0.86403, 0.31994, -1.58496],
    [0.86912, 0.45112, -1.35563, -1.58496, -0.33500, -0.05128, -1.35562, 0.67520],
    [-1.18052, -0.19656, 0.38301, 0.88234, -0.19656, -0.86498, 0.96437, -1.58496]]

    _SF2_ASF=[[-1.13966, 0.62168, -1.58497, 1.32362, -1.58496, -1.58496, 0.62167],
    [1.36553, -1.10378, 0.72505, 0.33007, 0.93876, -1.58496, -1.58496],
    [-0.21178, 0.17445, 0.47883, -1.58497, 0.33465, 0.99278, -0.10511],
    [-1.58496, -0.50085, -1.58496, -1.12725, -1.58497, -1.12725, 0.26844]]

    _SF2_ASF_IgM_BRCA1=[[-1.58496, 0.14630, -0.97480, 0.73608, -1.19324, -0.75317, 0.42996],
    [1.55079, -0.53374, 0.79022, 0.33028, 0.72108, -0.62083, -0.99443],
    [-1.34741, 0.44452, 0.40896, -0.98367, 0.51315, 1.02648, -0.00541],
    [-1.55427, -0.28495, -1.27864, -0.92448, -1.09071, -0.51682, 0.20226]]

    _SRp40=[[-0.13024, -1.58497, 1.27654, -0.32624, 0.96960, -0.13025, -1.58496],
    [0.56268, 0.68175, -1.11901, 1.24278, -0.76738, 0.13196, -0.04586],
    [-1.58496, -0.13980, -1.33225, -0.48155, -1.58496, 0.43758, 0.79678],
    [0.91938, 0.36969, 0.22927, -1.14186, 0.72387, -1.58496, -1.58496]]

    _SRp55=[[-0.66247, 0.11035, -0.66247, 0.11035, -1.58496, 0.61087],
    [0.39356, -1.58497, 1.47720, -1.58496, -1.58496, 0.97611],
    [-1.58496, 0.71901, -1.58496, 0.71901, 0.20637, -0.78720],
    [1.22431, -1.58497, -0.07450, -1.58496, 1.02024, -1.58496]]

    _SRSF1_threshold = 1.956
    _SRSF1_igM_threshold = 1.867
    _SRSF2_threshold = 2.383
    _SRSF5_threshold = 2.670
    _SRSF6_threshold = 2.676

    _A1_neuBG_threshold = 2.939
    _A1_winBG_threshold = 1.956
    _A1_Hazeem_threshold = 4.034
    _A1_Hazeem_july_threshold = 4.034

    motifs = {
        "A1_Hazeem": {
            "name": "A1_Hazeem",
            "matrix": _A1_Hazeem,
            "threshold": _A1_Hazeem_threshold
        },
        "A1_Hazeem_july": {
            "name": "A1_Hazeem_july",
            "matrix": _A1_Hazeem_july,
            "threshold": _A1_Hazeem_july_threshold
        },
        "A1_neuBG": {
            "name": "A1_neuBG",
            "matrix": _A1_neuBG,
            "threshold": _A1_neuBG_threshold
        },
        "A1_winBG": {
            "name": "A1_winBG",
            "matrix": _A1_winBG,
            "threshold": _A1_winBG_threshold
        },
        "SRSF1": {
            "name": "SRSF1",
            "matrix": _SF2_ASF,
            "threshold": _SRSF1_threshold
        },
        "SRSF1_igM": {
            "name": "SRSF1_igM",
            "matrix": _SF2_ASF_IgM_BRCA1,
            "threshold": _SRSF1_igM_threshold
        },
        "SRSF2": {
            "name": "SRSF2",
            "matrix": _SC35,
            "threshold": _SRSF2_threshold
        },
        "SRSF5": {
            "name": "SRSF5",
            "matrix": _SRp40,
            "threshold": _SRSF5_threshold
        },
        "SRSF6": {
            "name": "SRSF6",
            "matrix": _SRp55,
            "threshold": _SRSF6_threshold
        }
    }

def main():
    # SF2/ASF
    SRSF1 = [[-1.14,1.37,-0.21,-1.58],[0.62,-1.1,0.17,-0.5],
            [-1.58,0.73,0.48,-1.58],[1.32,0.33,-1.58,-1.13],
            [-1.58,0.94,0.33,-1.58],[-1.58,-1.58,0.99,-1.13],
            [0.62,-1.58,-0.11,0.27]]

    # SF2/ASF (IgM-BRCA1)
    SRSF1_igM = [[-1.58,1.55,-1.35,-1.55],[0.15,-0.53,0.44,-0.28],
                [-0.97,0.79,0.41,-1.28],[0.74,0.33,-0.98,-0.92],
                [-1.19,0.72,0.51,-1.09],[-0.75,-0.62,1.03,-0.52],
                [0.43,-0.99,0.0,0.2]]

    # SC35
    SRSF2 = [[-0.88,-1.16,0.87,-1.18],[0.09,-1.58,0.45,-0.2],
            [-0.06,0.95,-1.36,0.38],[-1.58,1.11,-1.58,0.88],
            [0.09,0.56,-0.33,-0.2],[-0.41,0.86,-0.05,-0.86],
            [-0.06,0.32,-1.36,0.96],[0.23,-1.58,0.68,-1.58]]

    # SRp40
    SRSF5 = [[-0.13,0.56,-1.58,0.92],[-1.58,0.68,-0.14,0.37],
            [1.28,-1.12,-1.33,0.23],[-0.33,1.24,-0.48,-1.14],
            [0.97,-0.77,-1.58,0.72],[-0.13,0.13,0.44,-1.58],
            [-1.58,-0.05,0.8,-1.58]]

    # SRp55
    SRSF6 = [[-0.66,0.39,-1.58,1.22],[0.11,-1.58,0.72,-1.58],
            [-0.66,1.48,-1.58,-0.07],[0.11,-1.58,0.72,-1.58], # Pos3 T was missing negative sign
            [-1.58,-1.58,0.21,1.02],[0.61,0.98,-0.79,-1.58]]
    
    SRSF1 = list(map(list, zip(*SRSF1)))
    SRSF1_igM = list(map(list, zip(*SRSF1_igM)))
    SRSF2 = list(map(list, zip(*SRSF2)))
    SRSF5 = list(map(list, zip(*SRSF5)))
    SRSF6 = list(map(list, zip(*SRSF6)))

    import numpy as np
    np.set_printoptions(suppress=True)
    for old, new in [(SRSF1, ESEfinder_motifs.motifs["SRSF1"]),
                     (SRSF1_igM, ESEfinder_motifs.motifs["SRSF1_igM"]),
                     (SRSF2, ESEfinder_motifs.motifs["SRSF2"]),
                     (SRSF5, ESEfinder_motifs.motifs["SRSF5"]),
                     (SRSF6, ESEfinder_motifs.motifs["SRSF6"])]:
        
        A = np.array(old)
        B = np.array(new["matrix"])

        print(f"diffs in old and new {new['name']}")
        print(np.subtract(A, B))
        print(np.amax(np.subtract(A, B)))
        # print(np.array_str(np.transpose(x:=np.exp2(A)), precision=3))
        # print(x.sum(0))

    print("hnRBPs")
    for rbp in [ESEfinder_motifs.motifs["A1_Hazeem"],
                ESEfinder_motifs.motifs["A1_Hazeem_july"],
                ESEfinder_motifs.motifs["A1_neuBG"],
                ESEfinder_motifs.motifs["A1_winBG"]]:
        rbp_matrix = rbp["matrix"]
        print(np.array_str(np.transpose(x:=np.exp2(rbp_matrix)), precision=3))
        print(x.sum(0))

if __name__ == "__main__":
    main()
